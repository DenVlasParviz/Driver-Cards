{"ast":null,"code":"import api from '@/services/authentication'; // наш axios‑инстанс\n\nconst state = {\n  products: []\n};\nconst mutations = {\n  initializeStore(state, newData) {\n    state.products = newData;\n  }\n};\nconst actions = {\n  async updateDriverNightStatus(_, {\n    driverId,\n    isNight\n  }) {\n    try {\n      await api.post(`/night/${driverId}`, {\n        isNight\n      });\n    } catch (err) {\n      console.error(\"Ошибка при обновлении режима 'ночь/день':\", err);\n    }\n  },\n  async loadVehicle({\n    commit\n  }) {\n    try {\n      const response = await api.get(\"/api/info/card\");\n      commit(\"initializeStore\", response.data);\n    } catch (err) {\n      console.log(err);\n      if (err.response && err.response.status === 401) {\n        // this.$router.push('/login');\n      }\n    }\n  },\n  async addVehicle({\n    dispatch\n  }, payload) {\n    try {\n      const {\n        isNight,\n        ...driverData\n      } = payload;\n\n      // 1. Создаём водителя в PostgreSQL (Только те поля, которые есть в таблице)\n      const response = await api.post(\"/api/info/card\", driverData);\n      const driverId = response.data.id;\n\n      // 2. Сохраняем \"ночной режим\" в MongoDB, если передан\n      if (typeof isNight !== 'undefined') {\n        await api.post(`/night/${driverId}`, {\n          isNight\n        });\n      }\n\n      // 3. Обновляем список\n      dispatch(\"loadVehicle\");\n    } catch (err) {\n      console.error(\"Ошибка при добавлении водителя:\", err);\n    }\n  },\n  async removeVehicle({\n    dispatch\n  }, id) {\n    await api.delete(`/api/info/card/${id}`);\n    dispatch(\"loadVehicle\");\n  }\n};\nconst getters = {\n  getVehicleInfo(state) {\n    return state.products;\n  }\n};\nexport default {\n  namespaced: true,\n  state,\n  mutations,\n  actions,\n  getters\n};","map":{"version":3,"names":["api","state","products","mutations","initializeStore","newData","actions","updateDriverNightStatus","_","driverId","isNight","post","err","console","error","loadVehicle","commit","response","get","data","log","status","addVehicle","dispatch","payload","driverData","id","removeVehicle","delete","getters","getVehicleInfo","namespaced"],"sources":["C:/Users/Денис/Desktop/Programming/Lesson11/client/src/store/modules/vehicles.js"],"sourcesContent":["import api from '@/services/authentication';  // наш axios‑инстанс\n\n\n\nconst state = {\n  products: [],\n};\n\nconst mutations = {\n  initializeStore(state, newData) {\n    state.products = newData;\n  },\n};\n\nconst actions = {\n\n  async updateDriverNightStatus(_, { driverId, isNight }) {\n    try {\n      await api.post(`/night/${driverId}`, { isNight });\n    } catch (err) {\n      console.error(\"Ошибка при обновлении режима 'ночь/день':\", err);\n    }\n  },\n\n\n  async loadVehicle({ commit }) {\n    try {\n\n\n      const response = await api.get(\"/api/info/card\");\n      commit(\"initializeStore\", response.data);\n    }\n    catch (err) {\n      console.log(err);\n      if (err.response && err.response.status === 401) {\n        // this.$router.push('/login');\n\n      }\n    }\n  },\n\n  async addVehicle({ dispatch }, payload) {\n    try {\n      const { isNight, ...driverData } = payload;\n\n      // 1. Создаём водителя в PostgreSQL (Только те поля, которые есть в таблице)\n      const response = await api.post(\"/api/info/card\", driverData);\n      const driverId = response.data.id;\n\n      // 2. Сохраняем \"ночной режим\" в MongoDB, если передан\n      if (typeof isNight !== 'undefined') {\n        await api.post(`/night/${driverId}`, { isNight });\n      }\n\n      // 3. Обновляем список\n      dispatch(\"loadVehicle\");\n    } catch (err) {\n      console.error(\"Ошибка при добавлении водителя:\", err);\n    }\n  },\n\n\n  async removeVehicle({ dispatch }, id) {\n    await api.delete(`/api/info/card/${id}`);\n    dispatch(\"loadVehicle\");\n  },\n};\n\nconst getters = {\n  getVehicleInfo(state) {\n    return state.products;\n  },\n};\n\nexport default {\n  namespaced: true,\n  state,\n  mutations,\n  actions,\n  getters,\n};\n"],"mappings":"AAAA,OAAOA,GAAG,MAAM,2BAA2B,CAAC,CAAE;;AAI9C,MAAMC,KAAK,GAAG;EACZC,QAAQ,EAAE;AACZ,CAAC;AAED,MAAMC,SAAS,GAAG;EAChBC,eAAeA,CAACH,KAAK,EAAEI,OAAO,EAAE;IAC9BJ,KAAK,CAACC,QAAQ,GAAGG,OAAO;EAC1B;AACF,CAAC;AAED,MAAMC,OAAO,GAAG;EAEd,MAAMC,uBAAuBA,CAACC,CAAC,EAAE;IAAEC,QAAQ;IAAEC;EAAQ,CAAC,EAAE;IACtD,IAAI;MACF,MAAMV,GAAG,CAACW,IAAI,CAAC,UAAUF,QAAQ,EAAE,EAAE;QAAEC;MAAQ,CAAC,CAAC;IACnD,CAAC,CAAC,OAAOE,GAAG,EAAE;MACZC,OAAO,CAACC,KAAK,CAAC,2CAA2C,EAAEF,GAAG,CAAC;IACjE;EACF,CAAC;EAGD,MAAMG,WAAWA,CAAC;IAAEC;EAAO,CAAC,EAAE;IAC5B,IAAI;MAGF,MAAMC,QAAQ,GAAG,MAAMjB,GAAG,CAACkB,GAAG,CAAC,gBAAgB,CAAC;MAChDF,MAAM,CAAC,iBAAiB,EAAEC,QAAQ,CAACE,IAAI,CAAC;IAC1C,CAAC,CACD,OAAOP,GAAG,EAAE;MACVC,OAAO,CAACO,GAAG,CAACR,GAAG,CAAC;MAChB,IAAIA,GAAG,CAACK,QAAQ,IAAIL,GAAG,CAACK,QAAQ,CAACI,MAAM,KAAK,GAAG,EAAE;QAC/C;MAAA;IAGJ;EACF,CAAC;EAED,MAAMC,UAAUA,CAAC;IAAEC;EAAS,CAAC,EAAEC,OAAO,EAAE;IACtC,IAAI;MACF,MAAM;QAAEd,OAAO;QAAE,GAAGe;MAAW,CAAC,GAAGD,OAAO;;MAE1C;MACA,MAAMP,QAAQ,GAAG,MAAMjB,GAAG,CAACW,IAAI,CAAC,gBAAgB,EAAEc,UAAU,CAAC;MAC7D,MAAMhB,QAAQ,GAAGQ,QAAQ,CAACE,IAAI,CAACO,EAAE;;MAEjC;MACA,IAAI,OAAOhB,OAAO,KAAK,WAAW,EAAE;QAClC,MAAMV,GAAG,CAACW,IAAI,CAAC,UAAUF,QAAQ,EAAE,EAAE;UAAEC;QAAQ,CAAC,CAAC;MACnD;;MAEA;MACAa,QAAQ,CAAC,aAAa,CAAC;IACzB,CAAC,CAAC,OAAOX,GAAG,EAAE;MACZC,OAAO,CAACC,KAAK,CAAC,iCAAiC,EAAEF,GAAG,CAAC;IACvD;EACF,CAAC;EAGD,MAAMe,aAAaA,CAAC;IAAEJ;EAAS,CAAC,EAAEG,EAAE,EAAE;IACpC,MAAM1B,GAAG,CAAC4B,MAAM,CAAC,kBAAkBF,EAAE,EAAE,CAAC;IACxCH,QAAQ,CAAC,aAAa,CAAC;EACzB;AACF,CAAC;AAED,MAAMM,OAAO,GAAG;EACdC,cAAcA,CAAC7B,KAAK,EAAE;IACpB,OAAOA,KAAK,CAACC,QAAQ;EACvB;AACF,CAAC;AAED,eAAe;EACb6B,UAAU,EAAE,IAAI;EAChB9B,KAAK;EACLE,SAAS;EACTG,OAAO;EACPuB;AACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}